.global __start
.extern main
.extern exit
.extern strlistlen
__start:
 
## here you might want to get the argc/argv pairs somehow and then push
## them onto the stack...
 
# push envs
push $0x4020000
# push argv
push $0x4000000
# calculate argc
call strlistlen
# push argc
push %eax
# call user entry point
call main
 
# call the 'kill me' syscall to end
push %eax
call exit
 
# loop in case we haven't yet rescheduled
lp:
hlt
jmp lp
